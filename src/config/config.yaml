# Minimal VPipe Configuration for Simulation Mode
# This file provides defaults for workers running in simulation mode
# Environment variables will override these settings

# Event source type (eventhub or eventhouse)
event_source: eventhub

# Kafka configuration
kafka:
  connection:
    bootstrap_servers: ${KAFKA_BOOTSTRAP_SERVERS:-kafka:9092}
    security_protocol: PLAINTEXT

  consumer_defaults:
    auto_offset_reset: earliest
    enable_auto_commit: false
    max_poll_records: 100

  producer_defaults:
    acks: "1"
    compression_type: "lz4"

  # XACT domain configuration
  xact:
    topics:
      events: "xact.events.raw"
      events_ingested: "xact.events.ingested"
      enrichment_pending: "xact.enrichment.pending"
      downloads_pending: "xact.downloads.pending"
      downloads_cached: "xact.downloads.cached"
      downloads_results: "xact.downloads.results"
      dlq: "xact.downloads.dlq"

    consumer_group_prefix: "xact"
    retry_delays: [10, 20, 40, 80]  # Shorter delays for simulation (10s, 20s, 40s, 80s)
    max_retries: 4

  # ClaimX domain configuration
  claimx:
    topics:
      events: "claimx.events.raw"
      enrichment_pending: "claimx.enrichment.pending"
      entities_rows: "claimx.entities.rows"
      downloads_pending: "claimx.downloads.pending"
      downloads_cached: "claimx.downloads.cached"
      downloads_results: "claimx.downloads.results"
      dlq: "claimx.downloads.dlq"

    consumer_group_prefix: "claimx"
    retry_delays: [10, 20, 40, 80]  # Shorter delays for simulation (10s, 20s, 40s, 80s)
    max_retries: 4

# Delta Lake configuration
delta:
  enable_writes: true

  # XACT domain delta tables
  xact:
    events_table_path: ""  # Will be set via DELTA_EVENTS_TABLE_PATH env var
    inventory_table_path: ""
    failed_table_path: ""

  # ClaimX domain delta tables
  claimx:
    events_table_path: ""  # Will be set via CLAIMX_EVENTS_TABLE_PATH env var
    inventory_table_path: ""
    failed_table_path: ""
    projects_table_path: ""
    contacts_table_path: ""
    media_table_path: ""
    tasks_table_path: ""
    task_templates_table_path: ""
    external_links_table_path: ""
    video_collab_table_path: ""

# Local Kafka configuration (for simulation)
local_kafka:
  bootstrap_servers: ${KAFKA_BOOTSTRAP_SERVERS:-kafka:9092}
  security_protocol: PLAINTEXT
  consumer_poll_timeout_ms: 1000
  producer_max_block_ms: 60000
