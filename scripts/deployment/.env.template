# Kafka Pipeline Environment Configuration for RHEL8 Deployment
#
# Copy this file to /opt/kafka-pipeline/config/.env and customize for your environment
# Make sure to set proper permissions: chmod 600 /opt/kafka-pipeline/config/.env

# =============================================================================
# Kafka Configuration
# =============================================================================

# Local Kafka broker connection
KAFKA_BOOTSTRAP_SERVERS=localhost:9092

# Kafka consumer settings
KAFKA_SESSION_TIMEOUT_MS=45000
KAFKA_MAX_POLL_INTERVAL_MS=300000
KAFKA_AUTO_OFFSET_RESET=earliest

# =============================================================================
# Event Source Configuration
# =============================================================================

# Event source type: eventhub, eventhouse, or dummy
EVENT_SOURCE=eventhouse

# Azure Event Hub (if EVENT_SOURCE=eventhub)
#EVENT_HUB_NAMESPACE=your-namespace.servicebus.windows.net:9093
#EVENT_HUB_TOPIC=your-event-hub-topic

# Microsoft Fabric Eventhouse (if EVENT_SOURCE=eventhouse)
XACT_EVENTHOUSE_CLUSTER_URL=https://your-cluster.kusto.windows.net
XACT_EVENTHOUSE_DATABASE=your-database
XACT_EVENTHOUSE_SOURCE_TABLE=your_source_table
XACT_EVENTHOUSE_POLL_INTERVAL_SECONDS=60
XACT_EVENTHOUSE_BATCH_SIZE=8000

# ClaimX Eventhouse configuration
CLAIMX_EVENTHOUSE_CLUSTER_URL=https://your-cluster.kusto.windows.net
CLAIMX_EVENTHOUSE_DATABASE=your-database
CLAIMX_EVENTHOUSE_SOURCE_TABLE=claimx_events_source
CLAIMX_EVENTHOUSE_POLL_INTERVAL_SECONDS=60
CLAIMX_EVENTHOUSE_BATCH_SIZE=8000

# =============================================================================
# Azure Authentication
# =============================================================================

# Azure authentication method
# Options: cli, managed-identity, service-principal
AZURE_AUTH_METHOD=managed-identity

# For managed identity (recommended for RHEL8 VM)
# No additional configuration needed - uses VM's managed identity

# For service principal (if not using managed identity)
#AZURE_CLIENT_ID=your-client-id
#AZURE_CLIENT_SECRET=your-client-secret
#AZURE_TENANT_ID=your-tenant-id

# For Azure CLI (development only)
# Requires: az login

# =============================================================================
# Delta Lake / OneLake Configuration
# =============================================================================

# XACT Delta table paths
DELTA_EVENTS_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/xact_events
DELTA_INVENTORY_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/xact_inventory
DELTA_FAILED_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/xact_failed

# ClaimX Delta table paths
CLAIMX_EVENTS_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_events
CLAIMX_INVENTORY_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_inventory
CLAIMX_PROJECTS_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_projects
CLAIMX_CONTACTS_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_contacts
CLAIMX_MEDIA_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_media
CLAIMX_TASKS_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_tasks
CLAIMX_TASK_TEMPLATES_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_task_templates
CLAIMX_EXTERNAL_LINKS_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_external_links
CLAIMX_VIDEO_COLLAB_TABLE_PATH=abfss://workspace@onelake.dfs.fabric.microsoft.com/lakehouse/Tables/claimx_video_collab

# =============================================================================
# ClaimX API Configuration
# =============================================================================

CLAIMX_API_BASE_URL=https://api.claimx.com
CLAIMX_API_KEY=your-api-key-here
CLAIMX_API_RATE_LIMIT=20

# =============================================================================
# Storage Configuration
# =============================================================================

# XACT S3 Storage
XACT_S3_BUCKET=your-xact-bucket
XACT_S3_REGION=us-east-1
#XACT_S3_ACCESS_KEY=your-access-key
#XACT_S3_SECRET_KEY=your-secret-key

# ClaimX S3 Storage
CLAIMX_S3_BUCKET=your-claimx-bucket
CLAIMX_S3_REGION=us-east-1
#CLAIMX_S3_ACCESS_KEY=your-access-key
#CLAIMX_S3_SECRET_KEY=your-secret-key

# OneLake upload configuration
ONELAKE_WORKSPACE_ID=your-workspace-id
ONELAKE_LAKEHOUSE_ID=your-lakehouse-id

# =============================================================================
# Logging Configuration
# =============================================================================

# Log directory
LOG_DIR=/opt/kafka-pipeline/logs

# Log format (json or text)
JSON_LOGS=true

# Log level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# =============================================================================
# Performance Tuning
# =============================================================================

# Download worker concurrency
XACT_DOWNLOAD_CONCURRENCY=20
CLAIMX_DOWNLOAD_CONCURRENCY=40

# Upload worker concurrency
XACT_UPLOAD_CONCURRENCY=50
CLAIMX_UPLOAD_CONCURRENCY=50

# Batch sizes
XACT_DELTA_BATCH_SIZE=4000
CLAIMX_DELTA_BATCH_SIZE=4000

# =============================================================================
# Plugin Configuration
# =============================================================================

# iTel Cabinet API
ITEL_API_BASE_URL=https://api.itel.com
ITEL_API_KEY=your-itel-api-key

# =============================================================================
# Monitoring & Observability
# =============================================================================

# Prometheus metrics (set per worker in systemd files)
# Ports are automatically assigned: 8000-8999

# OpenTelemetry (optional)
#OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
#OTEL_SERVICE_NAME=kafka-pipeline

# =============================================================================
# Development & Testing
# =============================================================================

# Disable Delta writes for testing
#NO_DELTA=false

# Dummy data source (for testing)
#DUMMY_EVENTS_PER_MINUTE=10.0
#DUMMY_BURST_MODE=false
